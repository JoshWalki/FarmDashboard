<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Farming Dashboard</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css"
    />
    <link rel="stylesheet" href="assests/css/styles.css" />
  </head>

  <body class="bg-dark text-light" data-bs-theme="dark">
    <!-- Navigation Bar -->
    <nav
      class="navbar navbar-expand-lg navbar-dark bg-farm-primary shadow-lg d-none"
      id="main-navbar"
    >
      <div class="container-fluid">
        <!-- Brand/Current Section -->
        <div class="navbar-brand d-flex align-items-center">
          <i class="bi bi-speedometer2 me-2"></i>
          <span id="navbar-section-title">Farm Dashboard</span>
          <div
            class="badge bg-farm-accent text-light ms-2 d-none"
            id="navbar-game-time"
          >
            <i class="bi bi-clock me-1"></i>
            <span>Loading...</span>
          </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="navbar-nav ms-auto d-flex flex-row gap-2">
          <button
            id="nav-refresh-btn"
            class="btn btn-outline-success btn-sm mx-5"
            onclick="dashboard.refreshData()"
            title="Refresh data from save files"
          >
            <i class="bi bi-arrow-clockwise me-1"></i>Refresh
          </button>

          <button
            id="nav-home-btn"
            class="btn btn-outline-farm-accent btn-sm d-none"
            onclick="dashboard.showLanding()"
            title="Return to dashboard"
          >
            <i class="bi bi-house-door me-1"></i>Home
          </button>

          <button
            id="nav-unload-btn"
            class="btn btn-outline-danger btn-sm"
            onclick="dashboard.unloadData()"
            title="Remove stored save folder data"
          >
            <i class="bi bi-trash me-1"></i>Unload
          </button>
        </div>
      </div>
    </nav>

    <main
      class="main-content position-relative max-height-vh-100 h-100 border-radius-lg"
    >
      <div class="container-fluid py-4">
        <!-- Header -->

        <!-- Folder Selection Card -->
        <div class="row mb-4">
          <div class="col-12">
            <div
              id="folder-selection"
              class="card shadow-sm border-farm-accent"
            >
              <div class="card-header bg-farm-primary text-white">
                <h5 class="card-title mb-0">
                  <i class="bi bi-folder2-open me-2"></i>
                  Select Save Folder
                </h5>
              </div>
              <div class="card-body">
                <div class="row align-items-center">
                  <div class="col-md-8">
                    <input
                      type="file"
                      class="d-none"
                      id="folder-input"
                      webkitdirectory
                      directory
                      multiple
                    />
                    <label for="folder-input" class="btn btn-farm-accent me-2">
                      <i class="bi bi-folder-plus me-1"></i>
                      Choose Save Folder
                    </label>
                    <button id="clear-folder-btn" class="btn btn-danger d-none">
                      <i class="bi bi-trash me-1"></i>
                      Clear Saved Data
                    </button>
                  </div>
                  <div class="col-md-4">
                    <span id="folder-path" class="text-muted fst-italic"
                      >No folder selected</span
                    >
                  </div>
                </div>
                <div class="mt-3">
                  <small class="text-muted">
                    <i class="bi bi-info-circle me-1"></i>
                    Select your Farming Simulator save folder.<br />
                    C:\Users\[YOURUSERNAME]\AppData\Local\Packages\GIANTSSoftware.FarmingSimulator25PC_fa8jxm5fj0esw\LocalCache\Local\save
                  </small>
                  <div class="mt-2">
                    <small class="text-warning">
                      <i class="bi bi-exclamation-triangle me-1"></i>
                      <strong>Important:</strong> Farming Simulator must be open
                      with the save loaded before selecting the folder.
                    </small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Landing Page -->
        <div id="landing-page" class="d-none">
          <div class="row mb-4">
            <div class="col-12 text-center">
              <h2 class="text-farm-accent mb-3">
                <i class="bi bi-speedometer2 me-2"></i>
                Farm Management Dashboard
              </h2>
              <p class="lead text-muted">
                Select a section below to manage your farm data
              </p>
              <div
                class="badge bg-farm-primary fs-6 mt-2"
                id="game-time-display"
              >
                <i class="bi bi-clock me-1"></i>
                Loading game time...
              </div>
            </div>
          </div>

          <!-- Navigation Cards -->
          <div class="row g-4">
            <div class="col-md-6 col-lg-4">
              <div
                class="card bg-secondary h-100 dashboard-nav-card"
                onclick="dashboard.showSection('livestock')"
              >
                <div class="card-body text-center p-4">
                  <div class="mb-3">
                    <i
                      class="bi bi-clipboard-data display-1 text-farm-accent"
                    ></i>
                  </div>
                  <h4 class="card-title text-farm-accent">Livestock</h4>
                  <p class="card-text text-muted">
                    Manage your animals, track health, breeding, and locations
                  </p>
                  <div class="mt-3">
                    <span class="badge bg-farm-success" id="livestock-count"
                      >Loading...</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6 col-lg-4">
              <div
                class="card bg-secondary h-100 dashboard-nav-card"
                onclick="dashboard.showSection('vehicles')"
              >
                <div class="card-body text-center p-4">
                  <div class="mb-3">
                    <i class="bi bi-truck display-1 text-farm-accent"></i>
                  </div>
                  <h4 class="card-title text-farm-accent">Vehicles</h4>
                  <p class="card-text text-muted">
                    View your fleet, maintenance status, and operating times
                  </p>
                  <div class="mt-3">
                    <span class="badge bg-farm-secondary" id="vehicle-count"
                      >Loading...</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6 col-lg-4">
              <div
                class="card bg-secondary h-100 dashboard-nav-card"
                onclick="dashboard.showSection('fields')"
              >
                <div class="card-body text-center p-4">
                  <div class="mb-3">
                    <i class="bi bi-geo-alt display-1 text-farm-accent"></i>
                  </div>
                  <h4 class="card-title text-farm-accent">Fields</h4>
                  <p class="card-text text-muted">
                    Monitor crop growth, soil conditions, and field management
                  </p>
                  <div class="mt-3">
                    <span class="badge bg-farm-warning" id="field-count"
                      >Loading...</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6 col-lg-4">
              <div
                class="card bg-secondary h-100 dashboard-nav-card"
                onclick="dashboard.showSection('economy')"
              >
                <div class="card-body text-center p-4">
                  <div class="mb-3">
                    <i class="bi bi-graph-up display-1 text-farm-accent"></i>
                  </div>
                  <h4 class="card-title text-farm-accent">Economy</h4>
                  <p class="card-text text-muted">
                    Track commodity prices, market trends, and finances
                  </p>
                  <div class="mt-3">
                    <span class="badge bg-farm-info" id="economy-info"
                      >Market Data</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6 col-lg-4">
              <div
                class="card bg-secondary h-100 dashboard-nav-card"
                onclick="dashboard.showSection('pastures')"
              >
                <div class="card-body text-center p-4">
                  <div class="mb-3">
                    <i class="bi bi-diagram-3 display-1 text-farm-accent"></i>
                  </div>
                  <h4 class="card-title text-farm-accent">Pastures</h4>
                  <p class="card-text text-muted">
                    Manage pastures, livestock, and grazing conditions
                  </p>
                  <div class="mt-3">
                    <span class="badge bg-farm-success" id="pasture-count"
                      >Loading...</span
                    >
                    <span
                      class="badge bg-farm-danger ms-2 d-none"
                      id="pasture-warnings-badge"
                    >
                      <i class="bi bi-exclamation-triangle me-1"></i>
                      <span id="pasture-warnings-count">0</span> Warnings
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6 col-lg-4">
              <div
                class="card bg-secondary h-100 dashboard-nav-card"
                onclick="dashboard.showSection('statistics')"
              >
                <div class="card-body text-center p-4">
                  <div class="mb-3">
                    <i class="bi bi-bar-chart display-1 text-farm-accent"></i>
                  </div>
                  <h4 class="card-title text-farm-accent">Statistics</h4>
                  <p class="card-text text-muted">
                    View comprehensive farm analytics and performance data
                  </p>
                  <div class="mt-3">
                    <span class="badge bg-farm-primary" id="stats-info"
                      >Analytics</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Content -->
        <div id="section-content" class="d-none">
          <!-- Back to Landing Button -->
          <div class="row mb-4">
            <div class="col-12">
              <button
                class="btn btn-outline-farm-accent"
                onclick="dashboard.showLanding()"
              >
                <i class="bi bi-arrow-left me-2"></i>Back to Dashboard
              </button>
            </div>
          </div>

          <!-- Dynamic section content will be loaded here -->
        </div>

        <!-- Dashboard/Livestock Content (Legacy - keeping for livestock section) -->
        <div id="dashboard-content" class="d-none">
          <div class="row mb-4">
            <div class="col-12 text-center">
              <h2 class="text-farm-accent">
                <i class="bi bi-clipboard-data me-2"></i>
                Livestock Management
              </h2>
            </div>
          </div>

          <!-- Tab Content -->
          <div class="tab-content" id="dashboard-tab-content">
            <!-- Animals Tab -->
            <div
              class="tab-pane fade show active mt-5"
              id="animals-tab"
              role="tabpanel"
            >
              <!-- Summary Cards -->
              <div class="row mb-4" id="animals-summary">
                <div class="col-md-3 mb-3">
                  <div
                    class="card bg-farm-primary text-white border-0 summary-card-clickable"
                    onclick="dashboard.filterAnimals('all')"
                    data-filter="all"
                  >
                    <div class="card-body">
                      <div class="d-flex justify-content-between">
                        <div>
                          <h6 class="card-title">Total Animals</h6>
                          <h2 class="mb-0" id="total-count">0</h2>
                        </div>
                        <div class="align-self-center">
                          <i class="bi bi-clipboard-data fs-1"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div
                    class="card bg-farm-primary text-white border-0 summary-card-clickable"
                    onclick="dashboard.filterAnimals('lactating')"
                    data-filter="lactating"
                  >
                    <div class="card-body">
                      <div class="d-flex justify-content-between">
                        <div>
                          <h6 class="card-title">Lactating</h6>
                          <h2 class="mb-0" id="lactating-count">0</h2>
                        </div>
                        <div class="align-self-center">
                          <i class="bi bi-droplet fs-1"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div
                    class="card bg-farm-primary text-white border-0 summary-card-clickable"
                    onclick="dashboard.filterAnimals('pregnant')"
                    data-filter="pregnant"
                  >
                    <div class="card-body">
                      <div class="d-flex justify-content-between">
                        <div>
                          <h6 class="card-title">Pregnant</h6>
                          <h2 class="mb-0" id="pregnant-count">0</h2>
                        </div>
                        <div class="align-self-center">
                          <i class="bi bi-heart fs-1"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <div
                    class="card bg-farm-primary text-white border-0 summary-card-clickable"
                    onclick="dashboard.filterAnimals('health')"
                    data-filter="health"
                  >
                    <div class="card-body">
                      <div class="d-flex justify-content-between">
                        <div>
                          <h6 class="card-title">Avg Health</h6>
                          <h2 class="mb-0" id="avg-health">0%</h2>
                        </div>
                        <div class="align-self-center">
                          <i class="bi bi-heart-pulse fs-1"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Livestock Filters -->
              <div class="row mb-4">
                <div class="col-12">
                  <div class="card shadow-lg border-farm-accent">
                    <div class="card-header text-white">
                      <h6 class="card-title mb-0">
                        <i class="bi bi-funnel me-2"></i>
                        Livestock Filters
                        <button
                          class="btn btn-sm btn-outline-light ms-2"
                          onclick="dashboard.toggleFilters()"
                          id="filter-toggle-btn"
                        >
                          <i class="bi bi-chevron-down"></i> Show Filters
                        </button>
                        <button
                          class="btn btn-sm btn-outline-warning ms-2"
                          onclick="dashboard.resetFilters()"
                          id="reset-filters-btn"
                        >
                          <i class="bi bi-arrow-clockwise me-1"></i> Reset
                        </button>
                      </h6>
                    </div>
                    <div class="card-body d-none" id="filters-panel">
                      <div class="row g-3">
                        <!-- Age Filter -->
                        <div class="col-md-3">
                          <label class="form-label text-farm-accent"
                            >Age Range (months)</label
                          >
                          <div class="d-flex gap-2">
                            <input
                              type="number"
                              class="form-control form-control-sm"
                              id="age-min"
                              placeholder="Min"
                              min="0"
                            />
                            <input
                              type="number"
                              class="form-control form-control-sm"
                              id="age-max"
                              placeholder="Max"
                              min="0"
                            />
                          </div>
                        </div>

                        <!-- Weight Filter -->
                        <div class="col-md-3">
                          <label class="form-label text-farm-accent"
                            >Weight Range (kg)</label
                          >
                          <div class="d-flex gap-2">
                            <input
                              type="number"
                              class="form-control form-control-sm"
                              id="weight-min"
                              placeholder="Min"
                              min="0"
                              step="0.1"
                            />
                            <input
                              type="number"
                              class="form-control form-control-sm"
                              id="weight-max"
                              placeholder="Max"
                              min="0"
                              step="0.1"
                            />
                          </div>
                        </div>

                        <!-- Health Filter -->
                        <div class="col-md-3">
                          <label class="form-label text-farm-accent"
                            >Health Range (%)</label
                          >
                          <div class="dual-range-container" data-type="health">
                            <div class="dual-range-track">
                              <div
                                class="dual-range-fill"
                                id="health-fill"
                              ></div>
                              <input
                                type="range"
                                class="dual-range-min"
                                id="health-min"
                                min="0"
                                max="100"
                                value="0"
                              />
                              <input
                                type="range"
                                class="dual-range-max"
                                id="health-max"
                                min="0"
                                max="100"
                                value="100"
                              />
                            </div>
                            <div class="dual-range-values">
                              <span class="range-value" id="health-min-value"
                                >0%</span
                              >
                              <span class="range-separator">-</span>
                              <span class="range-value" id="health-max-value"
                                >100%</span
                              >
                            </div>
                          </div>
                        </div>

                        <!-- Metabolism Filter -->
                        <div class="col-md-3">
                          <label class="form-label text-farm-accent"
                            >Metabolism Range (% of base)</label
                          >
                          <div
                            class="dual-range-container"
                            data-type="metabolism"
                          >
                            <div class="dual-range-track">
                              <div
                                class="dual-range-fill"
                                id="metabolism-fill"
                              ></div>
                              <input
                                type="range"
                                class="dual-range-min"
                                id="metabolism-min"
                                min="0"
                                max="200"
                                value="0"
                              />
                              <input
                                type="range"
                                class="dual-range-max"
                                id="metabolism-max"
                                min="0"
                                max="200"
                                value="200"
                              />
                            </div>
                            <div class="dual-range-values">
                              <span
                                class="range-value"
                                id="metabolism-min-value"
                                >0%</span
                              >
                              <span class="range-separator">-</span>
                              <span
                                class="range-value"
                                id="metabolism-max-value"
                                >200%</span
                              >
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="row g-3 mt-2">
                        <!-- Fertility Filter -->
                        <div class="col-md-3">
                          <label class="form-label text-farm-accent"
                            >Fertility Range (% of base)</label
                          >
                          <div
                            class="dual-range-container"
                            data-type="fertility"
                          >
                            <div class="dual-range-track">
                              <div
                                class="dual-range-fill"
                                id="fertility-fill"
                              ></div>
                              <input
                                type="range"
                                class="dual-range-min"
                                id="fertility-min"
                                min="0"
                                max="200"
                                value="0"
                              />
                              <input
                                type="range"
                                class="dual-range-max"
                                id="fertility-max"
                                min="0"
                                max="200"
                                value="200"
                              />
                            </div>
                            <div class="dual-range-values">
                              <span class="range-value" id="fertility-min-value"
                                >0%</span
                              >
                              <span class="range-separator">-</span>
                              <span class="range-value" id="fertility-max-value"
                                >200%</span
                              >
                            </div>
                          </div>
                        </div>

                        <!-- Quality Filter -->
                        <div class="col-md-3">
                          <label class="form-label text-farm-accent"
                            >Quality Range (% of base)</label
                          >
                          <div class="dual-range-container" data-type="quality">
                            <div class="dual-range-track">
                              <div
                                class="dual-range-fill"
                                id="quality-fill"
                              ></div>
                              <input
                                type="range"
                                class="dual-range-min"
                                id="quality-min"
                                min="0"
                                max="200"
                                value="0"
                              />
                              <input
                                type="range"
                                class="dual-range-max"
                                id="quality-max"
                                min="0"
                                max="200"
                                value="200"
                              />
                            </div>
                            <div class="dual-range-values">
                              <span class="range-value" id="quality-min-value"
                                >0%</span
                              >
                              <span class="range-separator">-</span>
                              <span class="range-value" id="quality-max-value"
                                >200%</span
                              >
                            </div>
                          </div>
                        </div>

                        <!-- Productivity Filter -->
                        <div class="col-md-3">
                          <label class="form-label text-farm-accent"
                            >Productivity Range (% of base)</label
                          >
                          <div
                            class="dual-range-container"
                            data-type="productivity"
                          >
                            <div class="dual-range-track">
                              <div
                                class="dual-range-fill"
                                id="productivity-fill"
                              ></div>
                              <input
                                type="range"
                                class="dual-range-min"
                                id="productivity-min"
                                min="0"
                                max="200"
                                value="0"
                              />
                              <input
                                type="range"
                                class="dual-range-max"
                                id="productivity-max"
                                min="0"
                                max="200"
                                value="200"
                              />
                            </div>
                            <div class="dual-range-values">
                              <span
                                class="range-value"
                                id="productivity-min-value"
                                >0%</span
                              >
                              <span class="range-separator">-</span>
                              <span
                                class="range-value"
                                id="productivity-max-value"
                                >200%</span
                              >
                            </div>
                          </div>
                        </div>

                        <!-- Animal Type Filter -->
                        <div class="col-md-3">
                          <label class="form-label text-farm-accent"
                            >Animal Type</label
                          >
                          <select
                            class="form-select form-select-sm"
                            id="animal-type-filter"
                          >
                            <option value="">All Types</option>
                            <option value="COW">Cows</option>
                            <option value="BULL">Bulls</option>
                            <option value="SHEEP">Sheep</option>
                            <option value="PIG">Pigs</option>
                            <option value="CHICKEN">Chickens</option>
                            <option value="HORSE">Horses</option>
                          </select>
                        </div>

                        <!-- Apply Filters Button -->
                        <div class="col-md-3 d-flex align-items-end">
                          <button
                            class="btn btn-farm-accent w-100"
                            onclick="dashboard.applyFilters()"
                          >
                            <i class="bi bi-search me-1"></i> Apply Filters
                          </button>
                        </div>
                      </div>

                      <!-- Active Filters Display -->
                      <div
                        class="mt-3"
                        id="active-filters"
                        style="display: none"
                      >
                        <small class="text-muted">Active Filters:</small>
                        <div id="active-filters-list" class="mt-1"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Animals Table -->
              <div class="row">
                <div class="col-12">
                  <div class="card shadow-lg border-farm-accent">
                    <div class="card-header text-white">
                      <h5 class="card-title mb-0">
                        <i class="bi bi-table me-2"></i>
                        Animals List
                      </h5>
                    </div>
                    <div class="card-body p-0">
                      <div class="table-responsive">
                        <table
                          id="animals-table"
                          class="table table-dark table-striped table-hover mb-0"
                        >
                          <thead class="bg-farm-accent text-dark">
                            <tr>
                              <th>ID</th>
                              <th>Name</th>
                              <th>Type</th>
                              <th>Age</th>
                              <th>Gender</th>
                              <th>Health</th>
                              <th>Weight</th>
                              <th>Value</th>
                              <th>Status</th>
                              <th>Location</th>
                              <th>Actions</th>
                            </tr>
                          </thead>
                          <tbody id="animals-tbody"></tbody>
                        </table>
                      </div>
                    </div>
                    <div class="card-footer border-0 text-center">
                      <button
                        class="btn btn-outline-farm-accent"
                        onclick="dashboard.showExportModal()"
                      >
                        <i class="bi bi-download me-2"></i>Export Data
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Statistics Tab -->
            <div class="tab-pane fade" id="statistics-tab" role="tabpanel">
              <div class="card shadow-lg border-warning">
                <div class="card-header bg-warning text-dark">
                  <h5 class="card-title mb-0">
                    <i class="bi bi-bar-chart me-2"></i>
                    Farm Statistics
                  </h5>
                </div>
                <div class="card-body">
                  <div id="stats-content">
                    <canvas id="stats-chart" width="400" height="200"></canvas>
                  </div>
                </div>
              </div>
            </div>

            <!-- Genetics Tab -->
            <div class="tab-pane fade" id="genetics-tab" role="tabpanel">
              <div class="card shadow-lg border-info">
                <div class="card-header bg-info text-white">
                  <h5 class="card-title mb-0">
                    <i class="bi bi-dna me-2"></i>
                    Genetics Overview
                  </h5>
                </div>
                <div class="card-body">
                  <div id="genetics-content">
                    <p class="text-muted">
                      Genetic data and breeding recommendations will appear
                      here.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Farm Selection Modal -->
        <div
          class="modal fade"
          id="farmSelectionModal"
          tabindex="-1"
          aria-labelledby="farmSelectionModalLabel"
          aria-hidden="true"
          data-bs-backdrop="static"
          data-bs-keyboard="false"
        >
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-light">
              <div class="modal-header bg-farm-primary">
                <h5 class="modal-title" id="farmSelectionModalLabel">
                  <i class="bi bi-house-door me-2"></i>
                  Select Farm
                </h5>
              </div>
              <div class="modal-body">
                <p class="text-muted mb-3">
                  <i class="bi bi-info-circle me-2"></i>
                  Multiple farms found in this save file. Please select which
                  farm's data you want to view:
                </p>
                <div class="list-group" id="farm-selection-list">
                  <!-- Farm options will be populated here -->
                </div>
              </div>
              <div class="modal-footer">
                <small class="text-muted me-auto"
                  >You can change this selection later from the dashboard</small
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Export Data Modal -->
        <div
          class="modal fade"
          id="exportDataModal"
          tabindex="-1"
          aria-labelledby="exportDataModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-light">
              <div class="modal-header bg-farm-primary">
                <h5 class="modal-title" id="exportDataModalLabel">
                  <i class="bi bi-download me-2"></i>
                  Export Livestock Data
                </h5>
                <button
                  type="button"
                  class="btn-close btn-close-white"
                  data-bs-dismiss="modal"
                ></button>
              </div>
              <div class="modal-body">
                <p class="text-muted mb-4">
                  <i class="bi bi-info-circle me-2"></i>
                  Choose your preferred export format for the livestock data:
                </p>

                <div class="row g-3">
                  <div class="col-12">
                    <button
                      class="btn btn-outline-farm-accent w-100 py-3"
                      onclick="dashboard.exportData('csv')"
                    >
                      <div
                        class="d-flex align-items-center justify-content-between"
                      >
                        <div class="d-flex align-items-center">
                          <i
                            class="bi bi-file-earmark-spreadsheet fs-4 me-3"
                          ></i>
                          <div class="text-start">
                            <div class="fw-bold">
                              CSV (Comma-Separated Values)
                            </div>
                            <small class="text-muted"
                              >Compatible with Excel, Google Sheets</small
                            >
                          </div>
                        </div>
                        <i class="bi bi-arrow-right"></i>
                      </div>
                    </button>
                  </div>

                  <div class="col-12">
                    <button
                      class="btn btn-outline-farm-accent w-100 py-3"
                      onclick="dashboard.exportData('excel')"
                    >
                      <div
                        class="d-flex align-items-center justify-content-between"
                      >
                        <div class="d-flex align-items-center">
                          <i class="bi bi-file-earmark-excel fs-4 me-3"></i>
                          <div class="text-start">
                            <div class="fw-bold">Excel (.xlsx)</div>
                            <small class="text-muted"
                              >Microsoft Excel format with formatting</small
                            >
                          </div>
                        </div>
                        <i class="bi bi-arrow-right"></i>
                      </div>
                    </button>
                  </div>

                  <div class="col-12">
                    <button
                      class="btn btn-outline-farm-accent w-100 py-3"
                      onclick="dashboard.exportData('pdf')"
                    >
                      <div
                        class="d-flex align-items-center justify-content-between"
                      >
                        <div class="d-flex align-items-center">
                          <i class="bi bi-file-earmark-pdf fs-4 me-3"></i>
                          <div class="text-start">
                            <div class="fw-bold">PDF Document</div>
                            <small class="text-muted"
                              >Printable report format</small
                            >
                          </div>
                        </div>
                        <i class="bi bi-arrow-right"></i>
                      </div>
                    </button>
                  </div>

                  <div class="col-12">
                    <button
                      class="btn btn-outline-farm-accent w-100 py-3"
                      onclick="dashboard.exportData('print')"
                    >
                      <div
                        class="d-flex align-items-center justify-content-between"
                      >
                        <div class="d-flex align-items-center">
                          <i class="bi bi-printer fs-4 me-3"></i>
                          <div class="text-start">
                            <div class="fw-bold">Print Preview</div>
                            <small class="text-muted"
                              >Print directly from browser</small
                            >
                          </div>
                        </div>
                        <i class="bi bi-arrow-right"></i>
                      </div>
                    </button>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Refresh Data Modal -->
        <div
          class="modal fade"
          id="refreshDataModal"
          tabindex="-1"
          aria-labelledby="refreshDataModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-dark text-light">
              <div class="modal-header bg-farm-success">
                <h5 class="modal-title" id="refreshDataModalLabel">
                  <i class="bi bi-arrow-clockwise me-2"></i>
                  Refresh Farm Data
                </h5>
                <button
                  type="button"
                  class="btn-close btn-close-white"
                  data-bs-dismiss="modal"
                ></button>
              </div>
              <div class="modal-body">
                <div class="text-center mb-4">
                  <i
                    class="bi bi-info-circle-fill text-farm-info fs-1 mb-3"
                  ></i>
                  <h6 class="text-farm-accent">
                    Get Latest Data from Save Files
                  </h6>
                  <h6 class="badge bg-danger">
                    Ensure to save in-game before loading data.
                  </h6>
                </div>

                <p class="text-muted mb-5">
                  To refresh with the latest data from your save files, you need
                  to re-select the save folder. This allows the browser to read
                  the updated files from disk.
                </p>

                <div
                  class="alert alert-info bg-farm-info text-dark border-0 mb-4"
                >
                  <i class="bi bi-shield-check me-2"></i>
                  <strong>Why?</strong> Browsers cannot automatically re-read
                  files from disk for security reasons.
                </div>

                <div class="row g-3">
                  <div class="col-12">
                    <button
                      class="btn btn-farm-accent w-100 py-3"
                      onclick="dashboard.confirmRefreshData(true)"
                      data-bs-dismiss="modal"
                    >
                      <div
                        class="d-flex align-items-center justify-content-between"
                      >
                        <div class="d-flex align-items-center">
                          <i class="bi bi-folder-plus fs-4 me-3"></i>
                          <div class="text-start">
                            <div class="fw-bold">
                              Re-select Folder (Recommended)
                            </div>
                            <small class="text-dark opacity-75">
                              Get fresh data with latest changes
                            </small>
                          </div>
                        </div>
                        <i class="bi bi-arrow-right"></i>
                      </div>
                    </button>
                  </div>

                  <div class="col-12">
                    <button
                      class="btn btn-outline-farm-accent w-100 py-3"
                      onclick="dashboard.confirmRefreshData(false)"
                      data-bs-dismiss="modal"
                    >
                      <div
                        class="d-flex align-items-center justify-content-between"
                      >
                        <div class="d-flex align-items-center">
                          <i class="bi bi-arrow-clockwise fs-4 me-3"></i>
                          <div class="text-start">
                            <div class="fw-bold">Refresh Display Only</div>
                            <small class="text-muted">
                              Use cached data (no file changes)
                            </small>
                          </div>
                        </div>
                        <i class="bi bi-arrow-right"></i>
                      </div>
                    </button>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Warning Details Modal -->
        <div
          class="modal fade"
          id="warningModal"
          tabindex="-1"
          aria-labelledby="warningModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-lg">
            <div class="modal-content bg-dark text-light">
              <div class="modal-header">
                <h5 class="modal-title" id="warningModalLabel">
                  <i class="bi bi-exclamation-triangle me-2 text-warning"></i>
                  Warning Details
                </h5>
                <button
                  type="button"
                  class="btn-close btn-close-white"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body">
                <div id="warningDetailsContent">
                  <!-- Warning details will be loaded here -->
                </div>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Animal Details Modal -->
        <div
          class="modal fade"
          id="animalDetailsModal"
          tabindex="-1"
          aria-labelledby="animalDetailsModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-xl">
            <div class="modal-content bg-dark text-light">
              <div class="modal-header bg-farm-primary">
                <h5 class="modal-title" id="animalDetailsModalLabel">
                  <i class="bi bi-clipboard-data me-2"></i>
                  Animal Details
                </h5>
                <button
                  type="button"
                  class="btn-close btn-close-white"
                  data-bs-dismiss="modal"
                ></button>
              </div>
              <div class="modal-body">
                <div id="animalDetailsContent">
                  <!-- Animal details will be loaded here -->
                </div>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Data Changes Modal -->
      <div
        class="modal fade"
        id="dataChangesModal"
        tabindex="-1"
        aria-labelledby="dataChangesModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-xl">
          <div class="modal-content bg-dark text-light">
            <div class="modal-header border-farm-accent">
              <h5 class="modal-title text-farm-accent" id="dataChangesModalLabel">
                <i class="bi bi-arrow-repeat me-2"></i>Save Data Changes
              </h5>
              <button
                type="button"
                class="btn-close btn-close-white"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div class="row">
                <div class="col-12">
                  <p class="text-muted mb-4">
                    <i class="bi bi-info-circle me-1"></i>
                    Changes detected since last refresh:
                  </p>
                </div>
              </div>
              
              <!-- Summary Cards -->
              <div class="row mb-4" id="changesSummaryCards">
                <!-- Cards will be populated by JavaScript -->
              </div>

              <!-- Detailed Changes Tabs -->
              <ul class="nav nav-pills mb-3" id="changesTabList" role="tablist">
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link active"
                    id="livestock-changes-tab"
                    data-bs-toggle="pill"
                    data-bs-target="#livestock-changes"
                    type="button"
                    role="tab"
                  >
                    <i class="bi bi-cow me-1"></i>Livestock
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link"
                    id="warnings-changes-tab"
                    data-bs-toggle="pill"
                    data-bs-target="#warnings-changes"
                    type="button"
                    role="tab"
                  >
                    <i class="bi bi-exclamation-triangle me-1"></i>Warnings
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link"
                    id="statistics-changes-tab"
                    data-bs-toggle="pill"
                    data-bs-target="#statistics-changes"
                    type="button"
                    role="tab"
                  >
                    <i class="bi bi-graph-up me-1"></i>Statistics
                  </button>
                </li>
              </ul>

              <!-- Tab Content -->
              <div class="tab-content" id="changesTabContent">
                <!-- Livestock Changes -->
                <div
                  class="tab-pane fade show active"
                  id="livestock-changes"
                  role="tabpanel"
                >
                  <div id="livestockChangesContent">
                    <!-- Content populated by JavaScript -->
                  </div>
                </div>

                <!-- Warnings Changes -->
                <div
                  class="tab-pane fade"
                  id="warnings-changes"
                  role="tabpanel"
                >
                  <div id="warningsChangesContent">
                    <!-- Content populated by JavaScript -->
                  </div>
                </div>

                <!-- Statistics Changes -->
                <div
                  class="tab-pane fade"
                  id="statistics-changes"
                  role="tabpanel"
                >
                  <div id="statisticsChangesContent">
                    <!-- Content populated by JavaScript -->
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer border-farm-accent">
              <button
                type="button"
                class="btn btn-outline-farm-accent"
                data-bs-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>

      <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
      <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
      <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
      <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
      <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
      <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
      <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>
      <script src="assests/js/app.js"></script>
    </main>
  </body>
</html>
